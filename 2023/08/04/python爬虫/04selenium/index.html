<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"tianhei.top","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Selenium 是一套 Web网站 的程序自动化操作 解决方案。通过它，我们可以写出自动化程序，像人一样在浏览器里操作web界面。 比如点击界面按钮，在文本框中输入文字 等操作。而且还能从web界面获取信息。 比如获取 火车、汽车票务信息，招聘网站职位信息，财经网站股票价格信息 等等，然后用程序进行分析处理。">
<meta property="og:type" content="article">
<meta property="og:title" content="selenium">
<meta property="og:url" content="http://tianhei.top/2023/08/04/python%E7%88%AC%E8%99%AB/04selenium/index.html">
<meta property="og:site_name" content="天海工作室">
<meta property="og:description" content="Selenium 是一套 Web网站 的程序自动化操作 解决方案。通过它，我们可以写出自动化程序，像人一样在浏览器里操作web界面。 比如点击界面按钮，在文本框中输入文字 等操作。而且还能从web界面获取信息。 比如获取 火车、汽车票务信息，招聘网站职位信息，财经网站股票价格信息 等等，然后用程序进行分析处理。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165016253.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165027164.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165036454.png">
<meta property="og:image" content="https://cdn2.byhy.net/imgs/gh/36257654_64305834-39fd8880-cfc3-11e9-9299-d1ec45405e1a.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165109999.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165119637.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165136726.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165143422.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165151786.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165205405.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165212707.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165220455.png">
<meta property="og:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165226538.png">
<meta property="article:published_time" content="2023-08-04T08:30:13.000Z">
<meta property="article:modified_time" content="2023-08-09T09:54:54.251Z">
<meta property="article:author" content="天海">
<meta property="article:tag" content="python">
<meta property="article:tag" content="爬虫　">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165016253.png">


<link rel="canonical" href="http://tianhei.top/2023/08/04/python%E7%88%AC%E8%99%AB/04selenium/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://tianhei.top/2023/08/04/python%E7%88%AC%E8%99%AB/04selenium/","path":"2023/08/04/python爬虫/04selenium/","title":"selenium"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>selenium | 天海工作室</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">天海工作室</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#selenium%E7%9A%84%E5%8E%9F%E7%90%86"><span class="nav-number">1.</span> <span class="nav-text">selenium的原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#selenium%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-number">2.</span> <span class="nav-text">selenium的安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%93"><span class="nav-number">2.1.</span> <span class="nav-text">安装客户端库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E6%B5%8F%E8%A7%88%E5%99%A8%E5%92%8C%E9%A9%B1%E5%8A%A8"><span class="nav-number">2.2.</span> <span class="nav-text">安装浏览器和驱动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.3.</span> <span class="nav-text">简单示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%81%E7%95%A5%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A9%B1%E5%8A%A8%E8%B7%AF%E5%BE%84"><span class="nav-number">2.4.</span> <span class="nav-text">省略浏览器驱动路径</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">选择元素的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE-id%E5%B1%9E%E6%80%A7-%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="nav-number">3.1.</span> <span class="nav-text">根据 id属性 选择元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE-class%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="nav-number">3.2.</span> <span class="nav-text">根据 class属性选择元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE-tag-%E5%90%8D-%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="nav-number">3.3.</span> <span class="nav-text">根据 tag 名 选择元素</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#find-element-%E5%92%8C-find-elements-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">3.3.1.</span> <span class="nav-text">find_element 和 find_elements 的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9A%E8%BF%87WebElement%E5%AF%B9%E8%B1%A1%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="nav-number">3.4.</span> <span class="nav-text">通过WebElement对象选择元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%89%E5%BE%85%E7%95%8C%E9%9D%A2%E5%85%83%E7%B4%A0%E5%87%BA%E7%8E%B0"><span class="nav-number">3.5.</span> <span class="nav-text">等待界面元素出现</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%93%8D%E6%8E%A7%E5%85%83%E7%B4%A0%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E6%B3%95"><span class="nav-number">4.</span> <span class="nav-text">操控元素的基本方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%82%B9%E5%87%BB%E5%85%83%E7%B4%A0"><span class="nav-number">4.1.</span> <span class="nav-text">点击元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E6%A1%86"><span class="nav-number">4.2.</span> <span class="nav-text">输入框</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E4%BF%A1%E6%81%AF"><span class="nav-number">4.3.</span> <span class="nav-text">获取元素信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B9"><span class="nav-number">4.3.1.</span> <span class="nav-text">获取元素的文本内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E5%B1%9E%E6%80%A7"><span class="nav-number">4.3.2.</span> <span class="nav-text">获取元素属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B4%E4%B8%AA%E5%85%83%E7%B4%A0%E5%AF%B9%E5%BA%94%E7%9A%84HTML"><span class="nav-number">4.3.3.</span> <span class="nav-text">获取整个元素对应的HTML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%BE%93%E5%85%A5%E6%A1%86%E9%87%8C%E9%9D%A2%E7%9A%84%E6%96%87%E5%AD%97"><span class="nav-number">4.3.4.</span> <span class="nav-text">获取输入框里面的文字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B92"><span class="nav-number">4.3.5.</span> <span class="nav-text">获取元素文本内容2</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#css%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">css表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CSS-Selector-%E8%AF%AD%E6%B3%95%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0%E5%8E%9F%E7%90%86"><span class="nav-number">5.1.</span> <span class="nav-text">CSS Selector 语法选择元素原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE-tag%E5%90%8D%E3%80%81id%E3%80%81class-%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="nav-number">5.2.</span> <span class="nav-text">根据 tag名、id、class 选择元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E6%8B%A9-%E5%AD%90%E5%85%83%E7%B4%A0-%E5%92%8C-%E5%90%8E%E4%BB%A3%E5%85%83%E7%B4%A0"><span class="nav-number">5.3.</span> <span class="nav-text">选择 子元素 和 后代元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9"><span class="nav-number">5.4.</span> <span class="nav-text">根据属性选择</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81-CSS-Selector"><span class="nav-number">5.5.</span> <span class="nav-text">验证 CSS Selector</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E8%AF%AD%E6%B3%95%E8%81%94%E5%90%88%E4%BD%BF%E7%94%A8"><span class="nav-number">5.6.</span> <span class="nav-text">选择语法联合使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9"><span class="nav-number">5.7.</span> <span class="nav-text">组选择</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%89%E6%AC%A1%E5%BA%8F%E9%80%89%E6%8B%A9%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-number">5.8.</span> <span class="nav-text">按次序选择子节点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%B6%E5%85%83%E7%B4%A0%E7%9A%84%E7%AC%ACn%E4%B8%AA%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-number">5.8.1.</span> <span class="nav-text">父元素的第n个子节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%B6%E5%85%83%E7%B4%A0%E7%9A%84%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-number">5.8.2.</span> <span class="nav-text">父元素的倒数第n个子节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%B6%E5%85%83%E7%B4%A0%E7%9A%84%E7%AC%AC%E5%87%A0%E4%B8%AA%E6%9F%90%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-number">5.8.3.</span> <span class="nav-text">父元素的第几个某类型的子节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%B6%E5%85%83%E7%B4%A0%E7%9A%84%E5%80%92%E6%95%B0%E7%AC%AC%E5%87%A0%E4%B8%AA%E6%9F%90%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-number">5.8.4.</span> <span class="nav-text">父元素的倒数第几个某类型的子节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A5%87%E6%95%B0%E8%8A%82%E7%82%B9%E5%92%8C%E5%81%B6%E6%95%B0%E8%8A%82%E7%82%B9"><span class="nav-number">5.8.5.</span> <span class="nav-text">奇数节点和偶数节点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9"><span class="nav-number">5.9.</span> <span class="nav-text">兄弟节点选择</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E9%82%BB%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9"><span class="nav-number">5.9.1.</span> <span class="nav-text">相邻兄弟节点选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%BB%AD%E6%89%80%E6%9C%89%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9"><span class="nav-number">5.9.2.</span> <span class="nav-text">后续所有兄弟节点选择</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#frame%E5%88%87%E6%8D%A2-%E7%AA%97%E5%8F%A3%E5%88%87%E6%8D%A2"><span class="nav-number">6.</span> <span class="nav-text">frame切换&#x2F;窗口切换</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%87%E6%8D%A2%E5%88%B0frame"><span class="nav-number">6.1.</span> <span class="nav-text">切换到frame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%87%E6%8D%A2%E5%88%B0%E6%96%B0%E7%9A%84%E7%AA%97%E5%8F%A3"><span class="nav-number">6.2.</span> <span class="nav-text">切换到新的窗口</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E6%A1%86"><span class="nav-number">7.</span> <span class="nav-text">选择框</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#radio%E6%A1%86"><span class="nav-number">7.1.</span> <span class="nav-text">radio框</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#checkbox%E6%A1%86"><span class="nav-number">7.2.</span> <span class="nav-text">checkbox框</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#select%E6%A1%86"><span class="nav-number">7.3.</span> <span class="nav-text">select框</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Select%E5%8D%95%E9%80%89%E6%A1%86"><span class="nav-number">7.3.1.</span> <span class="nav-text">Select单选框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Select%E5%A4%9A%E9%80%89%E6%A1%86"><span class="nav-number">7.3.2.</span> <span class="nav-text">Select多选框</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7"><span class="nav-number">8.</span> <span class="nav-text">实战技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A%E5%8A%A8%E4%BD%9C"><span class="nav-number">8.1.</span> <span class="nav-text">更多动作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8Cjavascript"><span class="nav-number">8.2.</span> <span class="nav-text">直接执行javascript</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%BB%E7%BB%93%E7%95%8C%E9%9D%A2"><span class="nav-number">8.3.</span> <span class="nav-text">冻结界面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%B9%E5%87%BA%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">8.4.</span> <span class="nav-text">弹出对话框</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Alert"><span class="nav-number">8.4.1.</span> <span class="nav-text">Alert</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Confirm"><span class="nav-number">8.4.2.</span> <span class="nav-text">Confirm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Prompt"><span class="nav-number">8.4.3.</span> <span class="nav-text">Prompt</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%8A%80%E5%B7%A7"><span class="nav-number">8.5.</span> <span class="nav-text">其他技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F"><span class="nav-number">8.5.1.</span> <span class="nav-text">窗口大小</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%AA%97%E5%8F%A3%E6%A0%87%E9%A2%98"><span class="nav-number">8.5.2.</span> <span class="nav-text">获取当前窗口标题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%AA%97%E5%8F%A3URL%E5%9C%B0%E5%9D%80"><span class="nav-number">8.5.3.</span> <span class="nav-text">获取当前窗口URL地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%AA%E5%B1%8F"><span class="nav-number">8.5.4.</span> <span class="nav-text">截屏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%8B%E6%9C%BA%E6%A8%A1%E5%BC%8F"><span class="nav-number">8.5.5.</span> <span class="nav-text">手机模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="nav-number">8.5.6.</span> <span class="nav-text">上传文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96Edge%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-number">8.6.</span> <span class="nav-text">自动化Edge浏览器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Xpath%E9%80%89%E6%8B%A9%E5%99%A8"><span class="nav-number">9.</span> <span class="nav-text">Xpath选择器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Xpath%E8%AF%AD%E6%B3%95%E7%AE%80%E4%BB%8B"><span class="nav-number">9.1.</span> <span class="nav-text">Xpath语法简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9"><span class="nav-number">9.1.1.</span> <span class="nav-text">绝对路径选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9"><span class="nav-number">9.1.2.</span> <span class="nav-text">相对路径选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-number">9.1.3.</span> <span class="nav-text">通配符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9-1"><span class="nav-number">9.2.</span> <span class="nav-text">根据属性选择</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AEid%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9"><span class="nav-number">9.2.1.</span> <span class="nav-text">根据id属性选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AEclass%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9"><span class="nav-number">9.2.2.</span> <span class="nav-text">根据class属性选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7"><span class="nav-number">9.2.3.</span> <span class="nav-text">根据其他属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E5%80%BC%E5%8C%85%E5%90%AB%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">9.2.4.</span> <span class="nav-text">属性值包含字符串</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%89%E6%AC%A1%E5%BA%8F%E9%80%89%E6%8B%A9"><span class="nav-number">9.3.</span> <span class="nav-text">按次序选择</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%90%E7%B1%BB%E5%9E%8B-%E7%AC%AC%E5%87%A0%E4%B8%AA-%E5%AD%90%E5%85%83%E7%B4%A0"><span class="nav-number">9.3.1.</span> <span class="nav-text">某类型 第几个 子元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%87%A0%E4%B8%AA%E5%AD%90%E5%85%83%E7%B4%A0"><span class="nav-number">9.3.2.</span> <span class="nav-text">第几个子元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%90%E7%B1%BB%E5%9E%8B-%E5%80%92%E6%95%B0%E7%AC%AC%E5%87%A0%E4%B8%AA-%E5%AD%90%E5%85%83%E7%B4%A0"><span class="nav-number">9.3.3.</span> <span class="nav-text">某类型 倒数第几个 子元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E9%80%89%E6%8B%A9"><span class="nav-number">9.3.4.</span> <span class="nav-text">范围选择</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9%E3%80%81%E7%88%B6%E8%8A%82%E7%82%B9%E3%80%81%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9"><span class="nav-number">9.4.</span> <span class="nav-text">组选择、父节点、兄弟节点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9-1"><span class="nav-number">9.4.1.</span> <span class="nav-text">组选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E7%88%B6%E8%8A%82%E7%82%B9"><span class="nav-number">9.4.2.</span> <span class="nav-text">选择父节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9-1"><span class="nav-number">9.4.3.</span> <span class="nav-text">兄弟节点选择</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#selenium-%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-number">9.5.</span> <span class="nav-text">selenium 注意点</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="天海"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">天海</p>
  <div class="site-description" itemprop="description">路漫漫其修远兮，吾将上下而求索！</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/tianheihj" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tianheihj" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:tianheiwy@163.com" title="E-Mail → mailto:tianheiwy@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://theme-next.iissnan.com/" title="https:&#x2F;&#x2F;theme-next.iissnan.com&#x2F;" rel="noopener" target="_blank">next主题配置</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tianhei.top/2023/08/04/python%E7%88%AC%E8%99%AB/04selenium/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="天海">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="天海工作室">
      <meta itemprop="description" content="路漫漫其修远兮，吾将上下而求索！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="selenium | 天海工作室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          selenium
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-08-04 16:30:13" itemprop="dateCreated datePublished" datetime="2023-08-04T16:30:13+08:00">2023-08-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-09 17:54:54" itemprop="dateModified" datetime="2023-08-09T17:54:54+08:00">2023-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%88%AC%E8%99%AB/" itemprop="url" rel="index"><span itemprop="name">爬虫</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Selenium 是一套 Web网站 的程序自动化操作 解决方案。通过它，我们可以写出自动化程序，像人一样在浏览器里操作web界面。 比如点击界面按钮，在文本框中输入文字 等操作。而且还能从web界面获取信息。 比如获取 火车、汽车票务信息，招聘网站职位信息，财经网站股票价格信息 等等，然后用程序进行分析处理。</p>
<span id="more"></span>
<h1 id="selenium的原理"><a href="#selenium的原理" class="headerlink" title="selenium的原理"></a>selenium的原理</h1><p>Selenium 的自动化原理是这样的</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165016253.png" alt="image-20230807165016253"></p>
<p>从上图可以看出：</p>
<p>我们写的自动化程序 需要使用 <strong>客户端库</strong>。</p>
<p>我们程序的自动化请求都是通过这个库里面的编程接口发送给浏览器。</p>
<p>比如，我们要模拟用户点击界面按钮， 自动化程序里面就应该 调用客户端库相应的函数， 就会发送 <strong>点击元素</strong> 的请求给 下方的 <strong>浏览器驱动</strong>。 然后，浏览器驱动再转发这个请求给浏览器。</p>
<p>这个自动化程序发送给浏览器驱动的请求 是HTTP请求。</p>
<p>客户端库从哪里来的？ 是Selenium组织提供的。</p>
<p>Selenium组织提供了多种 编程语言的Selenium客户端库， 包括 java，python，js， ruby等，方便不同编程语言的开发者使用。</p>
<p>我们只需要安装好客户端库，调用这些库，就可以发出自动化请求给浏览器咯。</p>
<p><strong>浏览器驱动</strong> 也是一个独立的程序，是由浏览器厂商提供的， 不同的浏览器需要不同的浏览器驱动。 比如 Chrome浏览器和 火狐浏览器有 各自不同的驱动程序。</p>
<p>浏览器驱动接收到我们的自动化程序发送的界面操作请求后，会转发请求给浏览器， 让浏览器去执行对应的自动化操作。</p>
<p>浏览器执行完操作后，会将自动化的<strong>结果</strong>返回给浏览器驱动， 浏览器驱动再通过HTTP响应的消息返回给我们的自动化程序的客户端库。</p>
<p>自动化程序的客户端库 接收到响应后，将结果转化为 <code>数据对象</code> 返回给 我们的代码。</p>
<p>我们的程序就可以知道这次自动化操作的结果如何了。</p>
<p>我们再总结一下，selenium 自动化流程如下：</p>
<ol>
<li>自动化程序调用Selenium 客户端库函数（比如点击按钮元素）</li>
<li>客户端库会发送Selenium 命令 给浏览器的驱动程序</li>
<li>浏览器驱动程序接收到命令后 ,驱动浏览器去执行命令</li>
<li>浏览器执行命令</li>
<li>浏览器驱动程序获取命令执行的结果，返回给我们自动化程序</li>
<li>自动化程序对返回结果进行处理</li>
</ol>
<h1 id="selenium的安装"><a href="#selenium的安装" class="headerlink" title="selenium的安装"></a>selenium的安装</h1><p>Selenium环境的安装主要就是安装两样东西：客户端库 和 浏览器 驱动 。</p>
<h2 id="安装客户端库"><a href="#安装客户端库" class="headerlink" title="安装客户端库"></a>安装客户端库</h2><p>不同的编程语言选择不同的Selenium客户端库。</p>
<p>对应我们Python语言来说，Selenium客户端库的安装非常简单，用 pip 命令即可。</p>
<p>打开 命令行程序，运行如下命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></table></figure>

<p>如果安装不了，可能是网络问题，可以指定使用国内的豆瓣源</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure>



<h2 id="安装浏览器和驱动"><a href="#安装浏览器和驱动" class="headerlink" title="安装浏览器和驱动"></a>安装浏览器和驱动</h2><p>浏览器驱动 是和 浏览器对应的。 不同的浏览器 需要选择不同的浏览器驱动。</p>
<p>目前主流的浏览器中，谷歌 Chrome 浏览器对 Selenium自动化的支持更加成熟一些。</p>
<p>推荐大家使用 Chrome浏览器 。</p>
<p><a target="_blank" rel="noopener" href="https://www.google.cn/chrome/">https://www.google.cn/chrome/</a></p>
<p>确保Chrome浏览器安装好以后，请大家打开下面的连接，访问Chrome 浏览器的驱动下载页面</p>
<p><a target="_blank" rel="noopener" href="https://chromedriver.storage.googleapis.com/index.html">https://chromedriver.storage.googleapis.com/index.html</a></p>
<p>注意浏览器驱动 必须要和浏览器版本匹配，下图红圈里面的版本号 就是和浏览器版本号对应的</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165027164.png" alt="image-20230807165027164"></p>
<p>比如：当前Chrome浏览器版本是98, 通常就需要下载98开头的目录里面的驱动程序 。</p>
<p>注意：驱动和浏览器的版本号越接近越好，但是略有差别，比如98和97 ，通常也没有什么问题。</p>
<p>打开目录，里面有3个zip包，分别对应Linux、Mac、Windows平台。</p>
<p>如果我们是Windows平台的电脑，就下载 chromedriver_win32.zip</p>
<p>这是个zip包，下载下来之后，解压里面的程序文件 chromedriver.exe 到某个目录下面，注意这个目录的路径最好是没有中文名和空格的。</p>
<p>比如，解压到 <code>d:\tools</code> 目录下面。</p>
<p>也就是保证我们的Chrome浏览器驱动路径为 <code>d:\tools\chromedriver.exe</code></p>
<p>基于selenium的web自动化环境搭建就是这些，比较简单。</p>
<h2 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h2><p>下面的代码, 可以自动化的 打开Chrome浏览器，并且自动化打开百度网站</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line">wd = webdriver.Chrome(service=Service(<span class="string">r&#x27;d:\tools\chromedriver.exe&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">wd.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>其中，下面这行代码，就会运行浏览器驱动，并且运行Chrome浏览器</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd = webdriver.Chrome(service=Service(<span class="string">r&#x27;d:\tools\chromedriver.exe&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>注意，等号右边 返回的是 WebDriver 类型的对象，我们可以通过这个对象来操控浏览器，比如 打开网址、选择界面元素等。</p>
<p>而下面这行代码，就是使用 WebDriver 的 get 方法 打开网址 百度</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>执行上面这行代码时，自动化程序就发起了 打开百度网址的 <code>请求消息</code> ，通过浏览器驱动， 给 Chrome浏览器。</p>
<p>Chome浏览器接收到该请求后，就会打开百度网址，通过浏览器驱动， 告诉自动化程序 打开成功。</p>
<p>执行完自动化代码，如果想关闭浏览器窗口可以调用WebDriver对象的 quit 方法，像这样 wd.quit()</p>
<h2 id="省略浏览器驱动路径"><a href="#省略浏览器驱动路径" class="headerlink" title="省略浏览器驱动路径"></a>省略浏览器驱动路径</h2><p>前面，我们的代码创建 WebDriver对象时，需要指定浏览器驱动路径，比如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line">wd = webdriver.Chrome(service=Service(<span class="string">r&#x27;d:\tools\chromedriver.exe&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>这样写有几个问题：</p>
<p>一是，比较麻烦， 每次写自动化代码都 要指定路径。二是，如果你的代码给别人运行，他的电脑上存放浏览器驱动的路径不一定和你一样（比如他的电脑是苹果Mac电脑），得改脚本。</p>
<p>有什么好办法呢？</p>
<p>我们可以把浏览器驱动 <code>所在目录</code> 加入环境变量 <code>Path</code> ， 写代码时，就可以无需指定浏览器驱动路径了，像下面这样</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd = webdriver.Chrome()</span><br></pre></td></tr></table></figure>

<p>因为，Selenium会自动在环境变量 Path 指定的那些目录里查找名为chromedriver.exe 的文件。</p>
<p>一定要注意的是， 加入环境变量 Path 的不是浏览器驱动全路径，比如 <code>d:\tools\chromedriver.exe</code>而是 浏览器驱动所在目录，比如 <code>d:\tools</code>而且设置完环境变量后，别忘了重启IDE（比如 PyCharm） 新的环境变量才会生效。</p>
<h1 id="选择元素的方法"><a href="#选择元素的方法" class="headerlink" title="选择元素的方法"></a>选择元素的方法</h1><blockquote>
<p>对应web自动化来说， 就是要告诉浏览器，你要操作的界面元素是什么。</p>
</blockquote>
<h2 id="根据-id属性-选择元素"><a href="#根据-id属性-选择元素" class="headerlink" title="根据 id属性 选择元素"></a>根据 id属性 选择元素</h2><p>打开百度，页面上有个输入框，使用鼠标右键菜单 查看该 input元素，会发现它有一个属性叫id。</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165036454.png" alt="image-20230807165036454"></p>
<p>我们可以把 id 想象成元素的编号， 是用来在html中标记该元素的。</p>
<p>根据规范， 如果元素有id属性 ，这个id 必须是当前html中唯一的。</p>
<p>所以如果元素有id， 根据id选择元素是最简单高效的方式。</p>
<p>下面的代码，可以自动化在浏览器中 访问百度网站，并且在输入框中搜索 <code>Python</code> 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象</span></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">wd.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据id选择元素，返回的就是该元素对应的WebElement对象</span></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;kw&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过该 WebElement对象，就可以对页面元素进行操作了</span></span><br><span class="line"><span class="comment"># 比如输入字符串到 这个 输入框里</span></span><br><span class="line">element.send_keys(<span class="string">&#x27;python\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>如果根据 传入的ID，找不到这样的元素，find_element 方法就会抛出 <code>selenium.common.exceptions.NoSuchElementException</code> 异常</p>
<h2 id="根据-class属性选择元素"><a href="#根据-class属性选择元素" class="headerlink" title="根据 class属性选择元素"></a>根据 class属性选择元素</h2><p>除了根据元素的id ，我们还可以根据元素的 $ \textcolor{red}{class}$ 属性选择元素。</p>
<p>元素也有类型， class 属性就用来标志着元素 <code>类型</code> ，</p>
<p>比如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;plant&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>土豆<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;plant&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>洋葱<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;plant&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>白菜<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animal&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>狮子<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animal&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>老虎<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animal&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>山羊<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>所有的植物元素都有个class属性 值为 plant。</p>
<p>所有的动物元素都有个class属性 值为 animal。</p>
<p>如果我们要选择 <strong>所有的动物</strong>， 就像下面可以这样写，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<p>find_elements 返回的是找到的符合条件的 <code>所有</code> 元素 (这里有3个元素)， 放在一个 <code>列表</code> 中返回。</p>
<p>而如果我们使用 <code>wd.find_element</code> (注意少了一个s) 方法， 就只会返回 <code>第一个</code> 元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 WebDriver 实例对象，指明使用chrome浏览器驱动</span></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># WebDriver 实例对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据 class name 选择元素，返回的是 一个列表</span></span><br><span class="line"><span class="comment"># 里面 都是class 属性值为 animal的元素对应的 WebElement对象</span></span><br><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出列表中的每个 WebElement对象，打印出其text属性的值</span></span><br><span class="line"><span class="comment"># text属性就是该 WebElement对象对应的元素在网页中的文本内容</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<p>通过 WebElement 对象的 <code>text属性</code> 可以获取该元素 在网页中的文本内容。</p>
<p>所以 下面的代码，可以打印出 element 对应 网页元素的 文本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(element.text)</span><br></pre></td></tr></table></figure>

<p>如果我们把</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>去掉一个s ，改为</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<p>那么返回的就是第一个class 属性为 animal的元素， 也就是这个元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animal&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>狮子<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>元素也可以有 <code>多个class类型</code> ，多个class类型的值之间用 <code>空格</code> 隔开，比如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;chinese student&quot;</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意，这里 span元素 有两个class属性，分别 是 chinese 和 student， 而不是一个 名为 <code>chinese student</code> 的属性。</p>
<p>我们要用代码选择这个元素，可以指定任意一个class 属性值，都可以选择到这个元素，如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_elements(By.CLASS_NAME,<span class="string">&#x27;chinese&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_elements(By.CLASS_NAME,<span class="string">&#x27;student&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>而不能这样写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_elements(By.CLASS_NAME,<span class="string">&#x27;chinese student&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="根据-tag-名-选择元素"><a href="#根据-tag-名-选择元素" class="headerlink" title="根据 tag 名 选择元素"></a>根据 tag 名 选择元素</h2><p>类似的，我们可以通过指定 参数为 <code>By.TAG_NAME</code> ，选择所有的tag名为 div的元素，如下所示</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据 tag name 选择元素，返回的是 一个列表</span></span><br><span class="line"><span class="comment"># 里面 都是 tag 名为 div 的元素对应的 WebElement对象</span></span><br><span class="line">elements = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出列表中的每个 WebElement对象，打印出其text属性的值</span></span><br><span class="line"><span class="comment"># text属性就是该 WebElement对象对应的元素在网页中的文本内容</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<h3 id="find-element-和-find-elements-的区别"><a href="#find-element-和-find-elements-的区别" class="headerlink" title="find_element 和 find_elements 的区别"></a>find_element 和 find_elements 的区别</h3><p>使用 <code>find_elements</code> 选择的是符合条件的 <code>所有</code> 元素， 如果没有符合条件的元素， <code>返回空列表</code></p>
<p>使用 <code>find_element</code> 选择的是符合条件的 <code>第一个</code> 元素， 如果没有符合条件的元素， <code>抛出 NoSuchElementException 异常</code></p>
<h2 id="通过WebElement对象选择元素"><a href="#通过WebElement对象选择元素" class="headerlink" title="通过WebElement对象选择元素"></a>通过WebElement对象选择元素</h2><p>不仅 WebDriver对象有 选择元素 的方法， WebElement对象 也有选择元素的方法。</p>
<p>WebElement对象 也可以调用 <code>find_elements</code>， <code>find_element</code> 之类的方法</p>
<p>WebDriver 对象 选择元素的范围是 整个 web页面， 而WebElement 对象 选择元素的范围是 该元素的内部。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">element = wd.find_element(By.ID,<span class="string">&#x27;container&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 限制 选择元素的范围是 id 为 container 元素的内部。</span></span><br><span class="line">spans = element.find_elements(By.TAG_NAME, <span class="string">&#x27;span&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> span <span class="keyword">in</span> spans:</span><br><span class="line">    <span class="built_in">print</span>(span.text)</span><br></pre></td></tr></table></figure>

<p>输出结果就只有</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">内层<span class="number">11</span></span><br><span class="line">内层<span class="number">12</span></span><br><span class="line">内层<span class="number">21</span></span><br></pre></td></tr></table></figure>

<h2 id="等待界面元素出现"><a href="#等待界面元素出现" class="headerlink" title="等待界面元素出现"></a>等待界面元素出现</h2><p>在我们进行网页操作的时候， 有的元素内容不是可以立即出现的， 可能会等待一段时间。</p>
<p>Selenium提供了一个更合理的解决方案，是这样的：</p>
<p>当发现元素没有找到的时候， <strong>并不立即返回</strong> 找不到元素的错误。而是周期性（每隔半秒钟）重新寻找该元素，直到该元素找到，或者超出指定最大等待时长，这时才 抛出异常（如果是 <code>find_elements</code> 之类的方法， 则是返回空列表）。</p>
<p>Selenium 的 Webdriver 对象 有个方法叫 <code>implicitly_wait</code> ，可以称之为 <code>隐式等待</code> ，或者 <code>全局等待</code> 。该方法接受一个参数， 用来指定 最大等待时长。</p>
<p>如果我们 加入如下代码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.implicitly_wait(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p>那么后续所有的 <code>find_element</code> 或者 <code>find_elements</code> 之类的方法调用 都会采用上面的策略：</p>
<p>如果找不到元素， 每隔 半秒钟 再去界面上查看一次， 直到找到该元素， 或者 过了10秒 最大时长。</p>
<p>这样，我们的百度搜索的例子的最终代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://www.byhy.net/_files/stock1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;kw&#x27;</span>)</span><br><span class="line"></span><br><span class="line">element.send_keys(<span class="string">&#x27;通讯\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回页面 ID为1 的元素</span></span><br><span class="line">element = wd.find_element(By.ID,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<h1 id="操控元素的基本方法"><a href="#操控元素的基本方法" class="headerlink" title="操控元素的基本方法"></a>操控元素的基本方法</h1><p>选择到元素之后，我们的代码会返回元素对应的 WebElement对象，通过这个对象，我们就可以 <code>操控</code> 元素了。</p>
<p>操控元素通常包括</p>
<ul>
<li>点击元素</li>
<li>在元素中输入字符串，通常是对输入框这样的元素</li>
<li>获取元素包含的信息，比如文本内容，元素的属性</li>
</ul>
<h2 id="点击元素"><a href="#点击元素" class="headerlink" title="点击元素"></a>点击元素</h2><p><code>点击元素</code> 非常简单，就是调用元素WebElement对象的 click方法。</p>
<p>当我们调用 WebElement 对象的 click 方法去点击 元素的时候， 浏览器接收到自动化命令，点击的是该元素的 <code>中心点</code> 位置 。</p>
<p>例如，对于下面的这样一个元素</p>
<p><img src="https://cdn2.byhy.net/imgs/gh/36257654_64305834-39fd8880-cfc3-11e9-9299-d1ec45405e1a.png" alt="out"></p>
<p>我们要点击 添加客户 这个按钮，既可以点击 右边对应的 绿色框子总的button 元素 ，也可以点击红色框子中的span元素 。</p>
<p>因为这两个元素的中心点都是 button 内部，都是有效点击区域</p>
<h2 id="输入框"><a href="#输入框" class="headerlink" title="输入框"></a>输入框</h2><p><code>输入字符串</code> 也非常简单，就是调用元素WebElement对象的send_keys方法。</p>
<p>如果我们要 把输入框中已经有的内容清除掉，可以使用WebElement对象的clear方法</p>
<p>我们要写一个自动化程序：要求在输入框中填入姓名：白月黑羽。</p>
<p>而且要做到输入框中已经有的提示字符，需要先 <code>清除掉</code></p>
<p>代码应该如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.ID, <span class="string">&quot;input1&quot;</span>)</span><br><span class="line"></span><br><span class="line">element.clear() <span class="comment"># 清除输入框已有的字符串</span></span><br><span class="line">element.send_keys(<span class="string">&#x27;白月黑羽&#x27;</span>) <span class="comment"># 输入新字符串</span></span><br></pre></td></tr></table></figure>

<h2 id="获取元素信息"><a href="#获取元素信息" class="headerlink" title="获取元素信息"></a>获取元素信息</h2><h3 id="获取元素的文本内容"><a href="#获取元素的文本内容" class="headerlink" title="获取元素的文本内容"></a>获取元素的文本内容</h3><p>通过WebElement对象的 <code>text</code> 属性，可以获取元素 <code>展示在界面上的</code> 文本内容。</p>
<p>比如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;animal&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<h3 id="获取元素属性"><a href="#获取元素属性" class="headerlink" title="获取元素属性"></a>获取元素属性</h3><p>通过WebElement对象的 <code>get_attribute</code> 方法来获取元素的属性值</p>
<p>比如要获取元素属性class的值，就可以使用 <code>element.get_attribute(&#39;class&#39;)</code></p>
<p>如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;input_name&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;class&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>执行完自动化代码，如果想关闭浏览器窗口可以调用WebDriver对象的 quit 方法，像这样 wd.quit()</p>
<h3 id="获取整个元素对应的HTML"><a href="#获取整个元素对应的HTML" class="headerlink" title="获取整个元素对应的HTML"></a>获取整个元素对应的HTML</h3><p>要获取整个元素对应的HTML文本内容，可以使用 <code>element.get_attribute(&#39;outerHTML&#39;)</code></p>
<p>如果，只是想获取某个元素 <code>内部</code> 的HTML文本内容，可以使用 <code>element.get_attribute(&#39;innerHTML&#39;)</code></p>
<h3 id="获取输入框里面的文字"><a href="#获取输入框里面的文字" class="headerlink" title="获取输入框里面的文字"></a>获取输入框里面的文字</h3><p>对于input输入框的元素，要获取里面的输入文本，用text属性是不行的，这时可以使用 <code>element.get_attribute(&#39;value&#39;)</code></p>
<p>比如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.ID, <span class="string">&quot;input1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;value&#x27;</span>)) <span class="comment"># 获取输入框中的文本</span></span><br></pre></td></tr></table></figure>

<h3 id="获取元素文本内容2"><a href="#获取元素文本内容2" class="headerlink" title="获取元素文本内容2"></a>获取元素文本内容2</h3><p>通过WebElement对象的 <code>text</code> 属性，可以获取元素 <code>展示在界面上的</code> 文本内容。</p>
<p>但是，有时候，元素的文本内容没有展示在界面上，或者没有完全完全展示在界面上。 这时，用WebElement对象的text属性，获取文本内容，就会有问题。</p>
<p>出现这种情况，可以尝试使用 <code>element.get_attribute(&#39;innerText&#39;)</code> ，或者 <code>element.get_attribute(&#39;textContent&#39;)</code></p>
<p>使用 innerText 和 textContent 的区别是，前者只显示元素可见文本内容，后者显示所有内容（包括display属性为none的部分）</p>
<h1 id="css表达式"><a href="#css表达式" class="headerlink" title="css表达式"></a>css表达式</h1><p>前面我们看到了根据 id、class属性、tag名 选择元素。</p>
<p>如果我们要选择的 元素 没有id、class 属性，或者有些我们不想选择的元素 也有相同的 id、class属性值，怎么办呢？</p>
<p>这时候我们通常可以通过 <code>CSS selector</code> 语法选择元素。</p>
<h2 id="CSS-Selector-语法选择元素原理"><a href="#CSS-Selector-语法选择元素原理" class="headerlink" title="CSS Selector 语法选择元素原理"></a>CSS Selector 语法选择元素原理</h2><p>HTML中经常要 为 某些元素 指定 <strong>显示效果</strong>，比如 前景文字颜色是红色， 背景颜色是黑色， 字体是微软雅黑等。</p>
<p>那么CSS必须告诉浏览器：要 <strong>选择哪些元素</strong> ， 来使用这样的显示风格。</p>
<p>既然 CSS Selector 语法 天生就是浏览器用来选择元素的，selenium自然就可以使用它用在自动化中，去选择要操作的元素了。</p>
<p>只要 CSS Selector 的语法是正确的， Selenium 就可以选择到该元素。</p>
<p>通过 CSS Selector 选择单个元素的方法是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find_element(By.CSS_SELECTOR, CSS Selector参数)</span><br></pre></td></tr></table></figure>

<p>选择所有元素的方法是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find_elements(By.CSS_SELECTOR, CSS Selector参数)</span><br></pre></td></tr></table></figure>

<p>CSS Selector 选择元素非常灵活强大， 大家可以从下面的例子看出来。</p>
<h2 id="根据-tag名、id、class-选择元素"><a href="#根据-tag名、id、class-选择元素" class="headerlink" title="根据 tag名、id、class 选择元素"></a>根据 tag名、id、class 选择元素</h2><p>CSS Selector 同样可以根据tag名、id 属性和 class属性 来 选择元素，</p>
<p>根据 tag名 选择元素的 CSS Selector 语法非常简单，直接写上tag名即可，</p>
<p>比如 要选择 所有的tag名为div的元素，就可以是这样</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>等价于</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>根据id属性 选择元素的语法是在id号前面加上一个井号： <code>#id值</code></p>
<p>有下面这样的元素：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;searchtext&#x27;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>就可以使用 <code>#searchtext</code> 这样的 CSS Selector 来选择它。</p>
<p>比如，我们想在 <code>id 为 searchtext</code> 的输入框中输入文本 <code>你好</code> ，完整的Python代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#searchtext&#x27;</span>)</span><br><span class="line">element.send_keys(<span class="string">&#x27;你好&#x27;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<p>根据class属性 选择元素的语法是在 class 值 前面加上一个点： <code>.class值</code></p>
<p>要选择<strong>所有</strong> class 属性值为 animal的元素 动物 除了这样写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>还可以这样写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;.animal&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>因为是选择 <code>所有</code> 符合条件的 ，所以用 <code>find_elements</code> 而不是 <code>find_element</code></p>
<h2 id="选择-子元素-和-后代元素"><a href="#选择-子元素-和-后代元素" class="headerlink" title="选择 子元素 和 后代元素"></a>选择 子元素 和 后代元素</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Z4411o7TA?p=13">点击这里，边看视频讲解，边学习以下内容</a></p>
<p>HTML中， 元素 内部可以 <strong>包含其他元素</strong>， 比如 下面的 HTML片段</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;container&#x27;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;layer1&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;inner11&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>内层11<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;inner12&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>内层12<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;layer2&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;inner21&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>内层21<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>下面的一段话有些绕口， 请 大家细心 阅读：</p>
<p>id 为 <code>container</code> 的div元素 包含了 id 为 <code>layer1</code> 和 <code>layer2</code> 的两个div元素。</p>
<p>这种包含是直接包含， 中间没有其他的层次的元素了。 所以 id 为 <code>layer1</code> 和 <code>layer2</code> 的两个div元素 是 id 为 <code>container</code> 的div元素 的 <strong>直接子元素</strong></p>
<p>而 id 为 <code>layer1</code> 的div元素 又包含了 id 为 <code>inner11</code> 和 <code>inner12</code> 的两个div元素。 中间没有其他层次的元素，所以这种包含关系也是 <strong>直接子元素</strong> 关系</p>
<p>id 为 <code>layer2</code> 的div元素 又包含了 id 为 <code>inner21</code> 这个div元素。 这种包含关系也是 <strong>直接子元素</strong> 关系</p>
<p>而对于 id 为 <code>container</code> 的div元素来说， id 为 <code>inner11</code> 、<code>inner12</code> 、<code>inner22</code> 的元素 和 两个 <code>span类型的元素</code> 都不是 它的直接子元素， 因为中间隔了 几层。</p>
<p>虽然不是直接子元素， 但是 它们还是在 <code>container</code> 的内部， 可以称之为它 的 <strong>后代元素</strong></p>
<p>后代元素也包括了直接子元素， 比如 id 为 <code>layer1</code> 和 <code>layer2</code> 的两个div元素 也可以说 是 id 为 <code>container</code> 的div元素 的 <strong>直接子元素，同时也是后代子元素</strong></p>
<p>如果 <code>元素2</code> 是 <code>元素1</code> 的 直接子元素， CSS Selector 选择子元素的语法是这样的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素1 &gt; 元素2</span><br></pre></td></tr></table></figure>

<p>中间用一个大于号 （我们可以理解为箭头号）</p>
<p>注意，最终选择的元素是 <strong>元素2</strong>， 并且要求这个 <strong>元素2</strong> 是 <strong>元素1</strong> 的直接子元素</p>
<p>也支持更多层级的选择， 比如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素1 &gt; 元素2 &gt; 元素3 &gt; 元素4</span><br></pre></td></tr></table></figure>

<p>就是选择 <code>元素1</code> 里面的子元素 <code>元素2</code> 里面的子元素 <code>元素3</code> 里面的子元素 <code>元素4</code> ， 最终选择的元素是 <strong>元素4</strong></p>
<p>如果 <code>元素2</code> 是 <code>元素1</code> 的 后代元素， CSS Selector 选择后代元素的语法是这样的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素1   元素2</span><br></pre></td></tr></table></figure>

<p>中间是一个或者多个空格隔开</p>
<p>最终选择的元素是 <strong>元素2</strong> ， 并且要求这个 <strong>元素2</strong> 是 <strong>元素1</strong> 的后代元素。</p>
<p>也支持更多层级的选择， 比如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素1   元素2   元素3  元素4</span><br></pre></td></tr></table></figure>

<p>最终选择的元素是 <strong>元素4</strong></p>
<h2 id="根据属性选择"><a href="#根据属性选择" class="headerlink" title="根据属性选择"></a>根据属性选择</h2><p>id、class 都是web元素的 <code>属性</code> ，因为它们是很常用的属性，所以css选择器专门提供了根据 id、class 选择的语法。</p>
<p>那么其他的属性呢？</p>
<p>比如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.miitbeian.gov.cn&quot;</span>&gt;</span>苏ICP备88885574号<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>里面根据 href选择，可以用css 选择器吗？</p>
<p>当然可以！</p>
<p>css 选择器支持通过任何属性来选择元素，语法是用一个方括号 <code>[]</code> 。</p>
<p>比如要选择上面的a元素，就可以使用 <code>[href=&quot;http://www.miitbeian.gov.cn&quot;]</code> 。</p>
<p>这个表达式的意思是，选择 属性href值为 <code>http://www.miitbeian.gov.cn</code> 的元素。</p>
<p>完整代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据属性选择元素</span></span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[href=&quot;http://www.miitbeian.gov.cn&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印出元素对应的html</span></span><br><span class="line"><span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>当然，前面可以加上标签名的限制，比如 <code>div[class=&#39;SKnet&#39;]</code> 表示 选择所有 标签名为div，且class属性值为SKnet的元素。</p>
<p>属性值用单引号，双引号都可以。</p>
<p>根据属性选择，还可以不指定属性值，比如 <code>[href]</code> ， 表示选择 所有 具有 属性名 为href 的元素，不管它们的值是什么。</p>
<p>CSS 还可以选择 属性值 <code>包含</code> 某个字符串 的元素</p>
<p>比如， 要选择a节点，里面的href属性包含了 miitbeian 字符串，就可以这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[href*=&quot;miitbeian&quot;]</span><br></pre></td></tr></table></figure>

<p>还可以 选择 属性值 以某个字符串 <code>开头</code> 的元素</p>
<p>比如， 要选择a节点，里面的href属性以 http 开头 ，就可以这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[href^=&quot;http&quot;]</span><br></pre></td></tr></table></figure>

<p>还可以 选择 属性值 以某个字符串 <code>结尾</code> 的元素</p>
<p>比如， 要选择a节点，里面的href属性以 gov.cn 结尾 ，就可以这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[href$=&quot;gov.cn&quot;]</span><br></pre></td></tr></table></figure>

<p>如果一个元素具有多个属性</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;misc&quot;</span> <span class="attr">ctype</span>=<span class="string">&quot;gun&quot;</span>&gt;</span>沙漠之鹰<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>CSS 选择器 可以指定 选择的元素要 同时具有多个属性的限制，像这样 <code>div[class=misc][ctype=gun]</code></p>
<h2 id="验证-CSS-Selector"><a href="#验证-CSS-Selector" class="headerlink" title="验证 CSS Selector"></a>验证 CSS Selector</h2><p>那么我们怎么验证 CSS Selector 的语法是否正确选择了我们要选择的元素呢？</p>
<p>当然可以像下面这样，写出Python代码，运行看看，能否操作成功</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#searchtext&#x27;</span>)</span><br><span class="line">element.<span class="built_in">input</span>(<span class="string">&#x27;输入的文本&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>如果成功，说明选择元素的语法是正确的。</p>
<p>但是这样做的问题就是：太麻烦了。</p>
<p>当我们进行自动化开发的时候，有大量选择元素的语句，都要这样一个个的验证，就非常耗时间。</p>
<p>由于 CSS Selector 是浏览器直接支持的，可以在浏览器 <strong>开发者工具栏</strong> 中验证。</p>
<p>比如我们使用Chrome浏览器打开 <a target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample1.html">https://cdn2.byhy.net/files/selenium/sample1.html</a></p>
<p>按F12 打开 开发者工具栏</p>
<p>如果我们要验证 下面的表达式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#bottom &gt; .footer2  a</span><br></pre></td></tr></table></figure>

<p>能否选中 这个元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.miitbeian.gov.cn&quot;</span>&gt;</span>苏ICP备88885574号<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以这样做：</p>
<p>点击 Elements 标签后， 同时按 Ctrl 键 和 F 键， 就会出现下图箭头处的 搜索框</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165109999.png" alt="image-20230807165109999"></p>
<p>我们可以在里面输入任何 CSS Selector 表达式 ，如果能选择到元素， 右边的的红色方框里面就会显示出类似 <code>2 of 3</code> 这样的内容。</p>
<p>of 后面的数字表示这样的表达式 <code>总共选择到几个元素</code></p>
<p>of 前面的数字表示当前黄色高亮显示的是 <code>其中第几个元素</code></p>
<p>上图中的 <code>1 of 1</code> 就是指 ： CSS 选择语法 <code>#bottom &gt; .footer2 a</code></p>
<p>在当前网页上共选择到 1 个元素， 目前高亮显示的是第1个。</p>
<p>如果我们输入 <code>.plant</code> 就会发现，可以选择到3个元素</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165119637.png" alt="image-20230807165119637"></p>
<h2 id="选择语法联合使用"><a href="#选择语法联合使用" class="headerlink" title="选择语法联合使用"></a>选择语法联合使用</h2><p>CSS selector的另一个强大之处在于： 选择语法 可以 <code>联合使用</code></p>
<p>比如， 我们要选择 网页 html 中的元素 <code>&lt;span class=&#39;copyright&#39;&gt;版权&lt;/span&gt;</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;bottom&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;footer1&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&#x27;copyright&#x27;</span>&gt;</span>版权<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&#x27;date&#x27;</span>&gt;</span>发布日期：2018-03-03<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;footer2&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>备案号</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.miitbeian.gov.cn&quot;</span>&gt;</span>苏ICP备88885574号<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>        </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span>         </span><br></pre></td></tr></table></figure>

<p>CSS selector 表达式 可以这样写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div.footer1 &gt; span.copyright</span><br></pre></td></tr></table></figure>

<p>就是 选择 一个class 属性值为 copyright 的 span 节点， 并且要求其 必须是 class 属性值为 footer1 的 div节点 的子节点</p>
<p>也可以更简单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.footer1 &gt; .copyright</span><br></pre></td></tr></table></figure>

<p>就是 选择 一个class 属性值为copyright 的节点（不限类型）， 并且要求其 必须是 class 属性值为 footer1 的节点的 子节点</p>
<p>当然 这样也是可以的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.footer1  .copyright</span><br></pre></td></tr></table></figure>

<p>因为子元素同时也是后代元素</p>
<h2 id="组选择"><a href="#组选择" class="headerlink" title="组选择"></a>组选择</h2><p>如果我们要 同时选择所有class 为 plant <code>和</code> class 为 animal 的元素。怎么办？</p>
<p>这种情况，css选择器可以 使用 <code>逗号</code> ，称之为 组选择 ，像这样</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.plant , .animal</span><br></pre></td></tr></table></figure>

<p>再比如，我们要同时选择所有tag名为div的元素 <code>和</code> id为BYHY的元素，就可以像这样写</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div,#BYHY</span><br></pre></td></tr></table></figure>

<p>对应的selenium代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;div,#BYHY&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<p>我们再看一个例子</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;t1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>唐诗<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>李白<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>静夜思<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>杜甫<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>春夜喜雨<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;t2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>宋词<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>辛弃疾<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>北固亭怀古<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们要选择所有 唐诗里面的作者和诗名， 也就是选择所有 id 为 t1 里面的 <code>span 和 p 元素</code></p>
<p>我们是不是应该这样写呢？</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#t1 &gt; span,p</span></span><br></pre></td></tr></table></figure>

<p>不行哦，这样写的意思是 选择所有 <code>id 为 t1 里面的 span</code> 和 <code>所有的 p 元素</code></p>
<p>只能这样写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#t1 &gt; span , #t1 &gt; p</span></span><br></pre></td></tr></table></figure>

<p>另外注意：组选择结果列表中，选中元素排序， 不是 组表达式的次序， 而是符合这些表达式的元素，在HTML文档中的出现的次序。</p>
<h2 id="按次序选择子节点"><a href="#按次序选择子节点" class="headerlink" title="按次序选择子节点"></a>按次序选择子节点</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;t1&#x27;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h3</span>&gt;</span> 唐诗 <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>李白<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>静夜思<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>杜甫<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>春夜喜雨<span class="tag">&lt;/<span class="name">p</span>&gt;</span>              </span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span>      </span><br><span class="line">    </span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;t2&#x27;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h3</span>&gt;</span> 宋词 <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>苏轼<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>赤壁怀古<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>明月几时有<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>江城子·乙卯正月二十日夜记梦<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>蝶恋花·春景<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>辛弃疾<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>京口北固亭怀古<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>青玉案·元夕<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>西江月·夜行黄沙道中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span>             </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="父元素的第n个子节点"><a href="#父元素的第n个子节点" class="headerlink" title="父元素的第n个子节点"></a>父元素的第n个子节点</h3><p>我们可以指定选择的元素 <code>是父元素的第几个子节点</code></p>
<p>使用 <code>nth-child</code></p>
<p>比如，</p>
<p>我们要选择 唐诗 和宋词 的第一个 作者，</p>
<p>也就是说 选择的是 第2个子元素，并且是span类型</p>
<p>所以这样可以这样写 <code>span:nth-child(2)</code> ，</p>
<p>如果你不加节点类型限制，直接这样写 <code>:nth-child(2)</code></p>
<p>就是选择所有位置为第2个的所有元素，不管是什么类型</p>
<h3 id="父元素的倒数第n个子节点"><a href="#父元素的倒数第n个子节点" class="headerlink" title="父元素的倒数第n个子节点"></a>父元素的倒数第n个子节点</h3><p>也可以反过来， 选择的是父元素的 <code>倒数第几个子节点</code> ，使用 <code>nth-last-child</code></p>
<p>比如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-last-child(1)</span><br></pre></td></tr></table></figure>

<p>就是选择第倒数第1个子元素，并且是p元素</p>
<h3 id="父元素的第几个某类型的子节点"><a href="#父元素的第几个某类型的子节点" class="headerlink" title="父元素的第几个某类型的子节点"></a>父元素的第几个某类型的子节点</h3><p>我们可以指定选择的元素 是父元素的第几个 <code>某类型的</code> 子节点</p>
<p>使用 <code>nth-of-type</code></p>
<p>比如，</p>
<p>我们要选择 唐诗 和宋词 的第一个 作者，</p>
<p>可以像上面那样思考：选择的是 第2个子元素，并且是span类型</p>
<p>所以这样可以这样写 <code>span:nth-child(2)</code> ，</p>
<p>还可以这样思考，选择的是 <code>第1个span类型</code> 的子元素</p>
<p>所以也可以这样写 <code>span:nth-of-type(1)</code></p>
<h3 id="父元素的倒数第几个某类型的子节点"><a href="#父元素的倒数第几个某类型的子节点" class="headerlink" title="父元素的倒数第几个某类型的子节点"></a>父元素的倒数第几个某类型的子节点</h3><p>当然也可以反过来， 选择父元素的 <code>倒数第几个某类型</code> 的子节点</p>
<p>使用 <code>nth-last-of-type</code></p>
<p>像这样</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-last-of-type(2)</span><br></pre></td></tr></table></figure>

<h3 id="奇数节点和偶数节点"><a href="#奇数节点和偶数节点" class="headerlink" title="奇数节点和偶数节点"></a>奇数节点和偶数节点</h3><p>如果要选择的是父元素的 <code>偶数节点</code>，使用 <code>nth-child(even)</code></p>
<p>比如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-child(even)</span><br></pre></td></tr></table></figure>

<p>如果要选择的是父元素的 <code>奇数节点</code>，使用 <code>nth-child(odd)</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-child(odd)</span><br></pre></td></tr></table></figure>

<p>如果要选择的是父元素的 <code>某类型偶数节点</code>，使用 <code>nth-of-type(even)</code></p>
<p>如果要选择的是父元素的 <code>某类型奇数节点</code>，使用 <code>nth-of-type(odd)</code></p>
<h2 id="兄弟节点选择"><a href="#兄弟节点选择" class="headerlink" title="兄弟节点选择"></a>兄弟节点选择</h2><h3 id="相邻兄弟节点选择"><a href="#相邻兄弟节点选择" class="headerlink" title="相邻兄弟节点选择"></a>相邻兄弟节点选择</h3><p>上面的例子里面，我们要选择 唐诗 和宋词 的第一个 作者</p>
<p>还有一种思考方法，就是选择 h3 <code>后面紧跟着的兄弟节点</code> span。</p>
<p>这就是一种 相邻兄弟 关系，可以这样写 <code>h3 + span</code></p>
<p>表示元素 紧跟关系的 是 <code>加号</code></p>
<h3 id="后续所有兄弟节点选择"><a href="#后续所有兄弟节点选择" class="headerlink" title="后续所有兄弟节点选择"></a>后续所有兄弟节点选择</h3><p>如果要选择是 选择 h3 <code>后面所有的兄弟节点</code> span，可以这样写 <code>h3 ~ span</code></p>
<h1 id="frame切换-窗口切换"><a href="#frame切换-窗口切换" class="headerlink" title="frame切换&#x2F;窗口切换"></a>frame切换&#x2F;窗口切换</h1><h2 id="切换到frame"><a href="#切换到frame" class="headerlink" title="切换到frame"></a>切换到frame</h2><p><a target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample2.html">请大家点击这里，打开这个链接</a></p>
<p>如果我们要 选择 下图方框中 所有的 蔬菜，使用css选择，怎么写表达式？</p>
<p>当然，要先查看到它们的html元素特征</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165136726.png" alt="image-20230807165136726"></p>
<p>大家可能会照旧写出如下代码：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据 class name 选择元素，返回的是 一个列表</span></span><br><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;plant&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<p>运行一下，你就会发现，运行结果打印内容为空白，说明没有选择到 class 属性值为 plant 的元素。</p>
<p>为什么呢？</p>
<p>因为仔细看，你可以发现， 这些元素是在一个叫 iframe的 元素中的。</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165143422.png" alt="image-20230807165143422"></p>
<p>这个 iframe 元素非常的特殊， 在html语法中，frame 元素 或者iframe元素的内部 会包含一个 <strong>被嵌入的</strong> 另一份html文档。</p>
<p>在我们使用selenium打开一个网页是， 我们的操作范围 缺省是当前的 html ， 并不包含被嵌入的html文档里面的内容。</p>
<p>如果我们要 操作 被嵌入的 html 文档 中的元素， 就必须 <code>切换操作范围</code> 到 被嵌入的文档中。</p>
<p>怎么切换呢？</p>
<p>使用 WebDriver 对象的 switch_to 属性，像这样</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.frame(frame_reference)</span><br></pre></td></tr></table></figure>

<p>其中， frame_reference 可以是 frame 元素的属性 name 或者 ID 。</p>
<p>比如这里，就可以填写 iframe元素的id ‘frame1’ 或者 name属性值 ‘innerFrame’。</p>
<p>像这样</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.frame(<span class="string">&#x27;frame1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.frame(<span class="string">&#x27;innerFrame&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>也可以填写frame 所对应的 WebElement 对象。</p>
<p>我们可以根据frame的元素位置或者属性特性，使用find系列的方法，选择到该元素，得到对应的WebElement对象</p>
<p>比如，这里就可以写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.frame(wd.find_element(By.TAG_NAME, <span class="string">&quot;iframe&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>然后，就可以进行后续操作frame里面的元素了。</p>
<p>上面的例子的正确代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先根据name属性值 &#x27;innerFrame&#x27;，切换到iframe中</span></span><br><span class="line">wd.switch_to.frame(<span class="string">&#x27;innerFrame&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据 class name 选择元素，返回的是 一个列表</span></span><br><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;plant&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<hr>
<p>如果我们已经切换到某个iframe里面进行操作了，那么后续选择和操作界面元素 就都是在这个frame里面进行的。</p>
<p>这时候，如果我们又需要操作 主html（我们把最外部的html称之为主html） 里面的元素了呢？</p>
<p>怎么切换回原来的主html呢？</p>
<p>很简单，写如下代码即可</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.default_content()</span><br></pre></td></tr></table></figure>

<p>例如，在上面 代码 操作完 frame里面的元素后， 需要 点击 主html 里面的按钮，就可以这样写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先根据name属性值 &#x27;innerFrame&#x27;，切换到iframe中</span></span><br><span class="line">wd.switch_to.frame(<span class="string">&#x27;innerFrame&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据 class name 选择元素，返回的是 一个列表</span></span><br><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;plant&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换回 最外部的 HTML 中</span></span><br><span class="line">wd.switch_to.default_content()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后再 选择操作 外部的 HTML 中 的元素</span></span><br><span class="line">wd.find_element_by_id(<span class="string">&#x27;outerbutton&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">wd.quit()</span><br></pre></td></tr></table></figure>

<h2 id="切换到新的窗口"><a href="#切换到新的窗口" class="headerlink" title="切换到新的窗口"></a>切换到新的窗口</h2><p>在网页上操作的时候，我们经常遇到，点击一个链接 或者 按钮，就会打开一个 <code>新窗口</code> 。</p>
<p><a target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample3.html">请大家点击这里，打开这个链接</a></p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165151786.png" alt="image-20230807165151786"></p>
<p>在打开的网页中，点击 链接 “访问bing网站” ， 就会弹出一个新窗口，访问bing网址。</p>
<p>如果我们用Selenium写自动化程序 <strong>在新窗口里面 打开一个新网址</strong>， 并且去自动化操作新窗口里面的元素，会有什么问题呢？</p>
<p>问题就在于，即使新窗口打开了， 这时候，我们的 WebDriver对象对应的 还是老窗口，自动化操作也还是在老窗口进行，</p>
<p>我们可以运行如下代码验证一下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample3.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击打开新窗口的链接</span></span><br><span class="line">link = wd.find_element(By.TAG_NAME, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">link.click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># wd.title属性是当前窗口的标题栏 文本</span></span><br><span class="line"><span class="built_in">print</span>(wd.title)</span><br></pre></td></tr></table></figure>

<p>运行完程序后，最后一行 打印当前窗口的标题栏 文本， 输出内容是</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">白月黑羽测试网页<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>说明， 我们的 WebDriver对象指向的还是老窗口，否则的话，运行结果就应该新窗口的标题栏 “微软Bing搜索”</p>
<hr>
<p>如果我们要到新的窗口里面操作，该怎么做呢？</p>
<p>可以使用Webdriver对象的switch_to属性的 window方法，如下所示：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.window(handle)</span><br></pre></td></tr></table></figure>

<p>其中，参数handle需要传入什么呢？</p>
<p>WebDriver对象有window_handles 属性，这是一个列表对象， 里面包括了当前浏览器里面<strong>所有的窗口句柄</strong>。</p>
<p>所谓句柄，大家可以想象成对应网页窗口的一个ID，</p>
<p>那么我们就可以通过 类似下面的代码，</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> handle <span class="keyword">in</span> wd.window_handles:</span><br><span class="line">    <span class="comment"># 先切换到该窗口</span></span><br><span class="line">    wd.switch_to.window(handle)</span><br><span class="line">    <span class="comment"># 得到该窗口的标题栏字符串，判断是不是我们要操作的那个窗口</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Bing&#x27;</span> <span class="keyword">in</span> wd.title:</span><br><span class="line">        <span class="comment"># 如果是，那么这时候WebDriver对象就是对应的该该窗口，正好，跳出循环，</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>上面代码的用意就是：</p>
<p>我们依次获取 wd.window_handles 里面的所有 句柄 对象， 并且调用 wd.switch_to.window(handle) 方法，切入到每个窗口，</p>
<p>然后检查里面该窗口对象的属性（可以是标题栏，地址栏），判断是不是我们要操作的那个窗口，如果是，就跳出循环。</p>
<hr>
<p>同样的，如果我们在新窗口 操作结束后， 还要回到原来的窗口，该怎么办？</p>
<p>我们可以仍然使用上面的方法，依次切入窗口，然后根据 标题栏 之类的属性值判断。</p>
<p>还有更省事的方法。</p>
<p>因为我们一开始就在 原来的窗口里面，我们知道 进入新窗口操作完后，还要回来，可以事先 保存该老窗口的 句柄，使用如下方法</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mainWindow变量保存当前窗口的句柄</span></span><br><span class="line">mainWindow = wd.current_window_handle</span><br></pre></td></tr></table></figure>

<p>切换到新窗口操作完后，就可以直接像下面这样，将driver对应的对象返回到原来的窗口</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通过前面保存的老窗口的句柄，自己切换到老窗口</span></span><br><span class="line">wd.switch_to.window(mainWindow)</span><br></pre></td></tr></table></figure>

<h1 id="选择框"><a href="#选择框" class="headerlink" title="选择框"></a>选择框</h1><p><a target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/test2.html">请点击打开这个网址</a></p>
<p>并且按F12，观察HTML的内容</p>
<p>常见的选择框包括： radio框、checkbox框、select框</p>
<h2 id="radio框"><a href="#radio框" class="headerlink" title="radio框"></a>radio框</h2><p>radio框选择选项，直接用WebElement的click方法，模拟用户点击就可以了。</p>
<p>比如, 我们要在下面的html中：</p>
<ul>
<li>先打印当前选中的老师名字</li>
<li>再选择 小雷老师</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;s_radio&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小江老师&quot;</span>&gt;</span>小江老师<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小雷老师&quot;</span>&gt;</span>小雷老师<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小凯老师&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span>&gt;</span>小凯老师</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对应的代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取当前选中的元素</span></span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR, </span><br><span class="line">  <span class="string">&#x27;#s_radio input[name=&quot;teacher&quot;]:checked&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;当前选中的是: &#x27;</span> + element.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点选 小雷老师</span></span><br><span class="line">wd.find_element(By.CSS_SELECTOR, </span><br><span class="line">  <span class="string">&#x27;#s_radio input[value=&quot;小雷老师&quot;]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<p>其中 <code>#s_radio input[name=&quot;teacher&quot;]:checked</code> 里面的 <code>:checked</code> 是CSS伪类选择</p>
<p>表示选择 <code>checked</code> 状态的元素，对 <code>radio</code> 和 <code>checkbox</code> 类型的input有效</p>
<h2 id="checkbox框"><a href="#checkbox框" class="headerlink" title="checkbox框"></a>checkbox框</h2><p>对checkbox进行选择，也是直接用 WebElement 的 click 方法，模拟用户点击选择。</p>
<p>需要注意的是，要选中checkbox的一个选项，必须 <code>先获取当前该复选框的状态</code> ，如果该选项已经勾选了，就不能再点击。否则反而会取消选择。</p>
<p>比如, 我们要在下面的html中：选中 小雷老师</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;s_checkbox&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小江老师&quot;</span>&gt;</span>小江老师<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小雷老师&quot;</span>&gt;</span>小雷老师<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小凯老师&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span>&gt;</span>小凯老师</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们的思路可以是这样：</p>
<ul>
<li>先把 已经选中的选项全部点击一下，确保都是未选状态</li>
<li>再点击 小雷老师</li>
</ul>
<p>示例代码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先把 已经选中的选项全部点击一下</span></span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, </span><br><span class="line">  <span class="string">&#x27;#s_checkbox input[name=&quot;teacher&quot;]:checked&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    element.click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再点击 小雷老师</span></span><br><span class="line">wd.find_element(By.CSS_SELECTOR, </span><br><span class="line">  <span class="string">&quot;#s_checkbox input[value=&#x27;小雷老师&#x27;]&quot;</span>).click()</span><br></pre></td></tr></table></figure>

<h2 id="select框"><a href="#select框" class="headerlink" title="select框"></a>select框</h2><p>radio框及checkbox框都是input元素，只是里面的type不同而已。</p>
<p>select框 则是一个新的select标签，大家可以对照浏览器网页内容查看一下</p>
<p>对于Select 选择框， Selenium 专门提供了一个 <code>Select类</code> 进行操作。</p>
<p>Select类 提供了如下的方法</p>
<ul>
<li>select_by_value</li>
</ul>
<p>根据选项的 <code>value属性值</code> ，选择元素。</p>
<p>比如，下面的HTML，</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;foo&quot;</span>&gt;</span>Bar<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>就可以根据 foo 这个值选择该选项，</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.select_by_value(<span class="string">&#x27;foo&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>select_by_index</li>
</ul>
<p>根据选项的 <code>次序</code> （从1开始），选择元素</p>
<ul>
<li>select_by_visible_text</li>
</ul>
<p>根据选项的 <code>可见文本</code> ，选择元素。</p>
<p>比如，下面的HTML，</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;foo&quot;</span>&gt;</span>Bar<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>就可以根据 Bar 这个内容，选择该选项</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.select_by_visible_text(<span class="string">&#x27;Bar&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>deselect_by_value</li>
</ul>
<p>根据选项的value属性值， <code>去除</code> 选中元素</p>
<ul>
<li>deselect_by_index</li>
</ul>
<p>根据选项的次序，<code>去除</code> 选中元素</p>
<ul>
<li>deselect_by_visible_text</li>
</ul>
<p>根据选项的可见文本，<code>去除</code> 选中元素</p>
<ul>
<li>deselect_all</li>
</ul>
<p><code>去除</code> 选中所有元素</p>
<h3 id="Select单选框"><a href="#Select单选框" class="headerlink" title="Select单选框"></a>Select单选框</h3><p>对于 select单选框，操作比较简单：</p>
<p>不管原来选的是什么，直接用Select方法选择即可。</p>
<p>例如，选择示例里面的小雷老师，示例代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入Select类</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Select对象</span></span><br><span class="line">select = Select(wd.find_element(By.ID, <span class="string">&quot;ss_single&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 Select 对象选中小雷老师</span></span><br><span class="line">select.select_by_visible_text(<span class="string">&quot;小雷老师&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Select多选框"><a href="#Select多选框" class="headerlink" title="Select多选框"></a>Select多选框</h3><p>对于select多选框，要选中某几个选项，要注意去掉原来已经选中的选项。</p>
<p>例如，我们选择示例多选框中的 小雷老师 和 小凯老师</p>
<p>可以用select类 的deselect_all方法，清除所有 已经选中 的选项。</p>
<p>然后再通过 select_by_visible_text方法 选择 小雷老师 和 小凯老师。</p>
<p>示例代码如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入Select类</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Select对象</span></span><br><span class="line">select = Select(wd.find_element(By.ID, <span class="string">&quot;ss_multi&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清除所有 已经选中 的选项</span></span><br><span class="line">select.deselect_all()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择小雷老师 和 小凯老师</span></span><br><span class="line">select.select_by_visible_text(<span class="string">&quot;小雷老师&quot;</span>)</span><br><span class="line">select.select_by_visible_text(<span class="string">&quot;小凯老师&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="实战技巧"><a href="#实战技巧" class="headerlink" title="实战技巧"></a>实战技巧</h1><h2 id="更多动作"><a href="#更多动作" class="headerlink" title="更多动作"></a>更多动作</h2><p>之前我们对web元素做的操作主要是：<strong>选择元素</strong>，然后 <strong>点击元素</strong> 或者 <strong>输入</strong> 字符串。</p>
<p>还有没有其他的操作了呢？</p>
<p>有。</p>
<p>比如：比如 鼠标右键点击、双击、移动鼠标到某个元素、鼠标拖拽等。</p>
<p>这些操作，可以通过 Selenium 提供的 <code>ActionChains</code> 类来实现。</p>
<p>ActionChains 类 里面提供了 一些特殊的动作的模拟，我们可以通过 ActionChains 类的代码查看到，如下所示</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165205405.png" alt="image-20230807165205405"></p>
<p>我们以移动鼠标到某个元素为例。</p>
<p>百度首页的右上角，有个 <strong>更多产品</strong> 选项，如下图所示</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165212707.png" alt="image-20230807165212707"></p>
<p>如果我们把鼠标放在上边，就会弹出 下面的 糯米、音乐、图片 等图标。</p>
<p>使用 ActionChains 来 模拟鼠标移动 操作的代码如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">ac = ActionChains(driver)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 鼠标移动到 元素上</span></span><br><span class="line">ac.move_to_element(</span><br><span class="line">    driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[name=&quot;tj_briicon&quot;]&#x27;</span>)</span><br><span class="line">).perform()</span><br></pre></td></tr></table></figure>

<h2 id="直接执行javascript"><a href="#直接执行javascript" class="headerlink" title="直接执行javascript"></a>直接执行javascript</h2><p>我们可以直接让浏览器运行一段javascript代码，并且得到返回值，如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接执行 javascript，里面可以直接用return返回我们需要的数据</span></span><br><span class="line">nextPageButtonDisabled = driver.execute_script(</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ele = document.querySelector(&#x27;.soupager &gt; button:last-of-type&#x27;);</span></span><br><span class="line"><span class="string">    return ele.getAttribute(&#x27;disabled&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回的数据转化为Python中的数据对象进行后续处理</span></span><br><span class="line"><span class="keyword">if</span> nextPageButtonDisabled == <span class="string">&#x27;disabled&#x27;</span>: <span class="comment"># 是最后一页</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># 不是最后一页</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>





<p>有时，自动化的网页内容很长，或者很宽，超过一屏显示，</p>
<p>如果我们要点击的元素不在窗口可见区内，新版本的selenium协议， 浏览器发现要操作（比如点击操作）的元素，不在可见区内，往往会操作失败，</p>
<p>出现类似下面的提示</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">element click intercepted: Element <span class="tag">&lt;<span class="name">span</span>&gt;</span>这里是元素html<span class="tag">&lt;/<span class="name">span</span>&gt;</span> </span><br><span class="line">is not clickable at point (119, 10). </span><br><span class="line">Other element would receive the click: <span class="tag">&lt;<span class="name">div</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这时，可以调用 <code>execute_script</code> 直接执行js代码，让该元素出现在窗口可见区正中</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].scrollIntoView(&#123;block:&#x27;center&#x27;,inline:&#x27;center&#x27;&#125;)&quot;</span>, job) </span><br></pre></td></tr></table></figure>

<p>其中 <code>arguments[0]</code> 就指代了后面的第一个参数 <code>job</code> 对应的js对象，</p>
<p>js对象的 <code>scrollIntoView</code> 方法，就是让元素滚动到可见部分</p>
<p><code>block:&#39;center&#39;</code> 指定垂直方向居中</p>
<p><code>inline:&#39;center&#39;</code> 指定水平方向居中</p>
<h2 id="冻结界面"><a href="#冻结界面" class="headerlink" title="冻结界面"></a>冻结界面</h2><p>有些网站上面的元素， 我们鼠标放在上面，会动态弹出一些内容。</p>
<p>比如，百度首页的右上角，有个 <strong>更多产品</strong> 选项，如下图所示</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165220455.png" alt="image-20230807165220455"></p>
<p>如果我们把鼠标放在上边，就会弹出 下面的 糯米、音乐、图片 等图标。</p>
<p>如果我们要用 selenium 自动化 点击 糯米图标，就需要 F12 查看这个元素的特征。</p>
<p>但是 当我们的鼠标 从 糯米图标 移开， 这个 栏目就整个消失了， 就没法 查看 其对应的 HTML。</p>
<p>怎么办？</p>
<p>可以如下图所示：</p>
<p><img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/image-20230807165226538.png" alt="image-20230807165226538"></p>
<p>在 开发者工具栏 console 里面执行如下js代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">debugger</span>&#125;, <span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>这句代码什么意思呢？</p>
<p>表示在 5000毫秒后，执行 debugger 命令</p>
<p>执行该命令会 浏览器会进入debug状态。 debug状态有个特性， 界面被冻住， 不管我们怎么点击界面都不会触发事件。</p>
<p>所以，我们可以在输入上面代码并回车 执行后， 立即 鼠标放在界面 右上角 更多产品处。</p>
<p>这时候，就会弹出 下面的 糯米、音乐、图片 等图标。</p>
<p>然后，我们仔细等待 5秒 到了以后， 界面就会因为执行了 debugger 命令而被冻住。</p>
<p>然后，我们就可以点击 开发者工具栏的 查看箭头， 再去 点击 糯米图标 ，查看其属性了。</p>
<h2 id="弹出对话框"><a href="#弹出对话框" class="headerlink" title="弹出对话框"></a>弹出对话框</h2><p>有的时候，我们经常会在操作界面的时候，出现一些弹出的对话框。</p>
<p><a target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/test4.html">请点击打开这个网址</a></p>
<p>分别点击界面的3个按钮，你可以发现：</p>
<p>弹出的对话框有三种类型，分别是 Alert（警告信息）、confirm（确认信息）和prompt（提示输入）</p>
<h3 id="Alert"><a href="#Alert" class="headerlink" title="Alert"></a>Alert</h3><p>Alert 弹出框，目的就是显示通知信息，只需用户看完信息后，点击 OK（确定） 就可以了。</p>
<p>那么，自动化的时候，代码怎么模拟用户点击 OK 按钮呢？</p>
<p>selenium提供如下方法进行操作</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.alert.accept()</span><br></pre></td></tr></table></figure>

<p>注意：如果我们不去点击它，页面的其它元素是不能操作的。</p>
<p>如果程序要获取弹出对话框中的信息内容， 可以通过 如下代码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.alert.text</span><br></pre></td></tr></table></figure>

<p>示例代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test4.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- alert ---</span></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b1&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 弹出框 提示信息</span></span><br><span class="line"><span class="built_in">print</span>(driver.switch_to.alert.text) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击 OK 按钮</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br></pre></td></tr></table></figure>

<h3 id="Confirm"><a href="#Confirm" class="headerlink" title="Confirm"></a>Confirm</h3><p>Confirm弹出框，主要是让用户确认是否要进行某个操作。</p>
<p>比如：当管理员在网站上选择删除某个账号时，就可能会弹出 Confirm弹出框， 要求确认是否确定要删除。</p>
<p>Confirm弹出框 有两个选择供用户选择，分别是 OK 和 Cancel， 分别代表 确定 和 取消 操作。</p>
<p>那么，自动化的时候，代码怎么模拟用户点击 OK 或者 Cancel 按钮呢？</p>
<p>selenium提供如下方法进行操作</p>
<p>如果我们想点击 OK 按钮， 还是用刚才的 accept方法，如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.alert.accept()</span><br></pre></td></tr></table></figure>

<p>如果我们想点击 Cancel 按钮， 可以用 dismiss方法，如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.alert.dismiss()</span><br></pre></td></tr></table></figure>

<p>示例代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test4.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- confirm ---</span></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b2&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 弹出框 提示信息</span></span><br><span class="line"><span class="built_in">print</span>(driver.switch_to.alert.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击 OK 按钮 </span></span><br><span class="line">driver.switch_to.alert.accept()</span><br><span class="line"></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b2&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击 取消 按钮</span></span><br><span class="line">driver.switch_to.alert.dismiss()</span><br></pre></td></tr></table></figure>

<h3 id="Prompt"><a href="#Prompt" class="headerlink" title="Prompt"></a>Prompt</h3><p>出现 Prompt 弹出框 是需要用户输入一些信息，提交上去。</p>
<p>比如：当管理员在网站上选择给某个账号延期时，就可能会弹出 Prompt 弹出框， 要求输入延期多长时间。</p>
<p>可以调用如下方法</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.alert.send_keys()</span><br></pre></td></tr></table></figure>

<p>示例代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test4.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- prompt ---</span></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b3&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取 alert 对象</span></span><br><span class="line">alert = driver.switch_to.alert</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 弹出框 提示信息</span></span><br><span class="line"><span class="built_in">print</span>(alert.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入信息，并且点击 OK 按钮 提交</span></span><br><span class="line">alert.send_keys(<span class="string">&#x27;web自动化 - selenium&#x27;</span>)</span><br><span class="line">alert.accept()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击 Cancel 按钮 取消</span></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b3&#x27;</span>).click()</span><br><span class="line">alert = driver.switch_to.alert</span><br><span class="line">alert.dismiss()</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong> ： 有些弹窗并非浏览器的alert 窗口，而是<strong>html元素</strong>，这种对话框，只需要通过之前介绍的选择器选中并进行相应的操作就可以了。</p>
<h2 id="其他技巧"><a href="#其他技巧" class="headerlink" title="其他技巧"></a>其他技巧</h2><p>下面是一些其他的 Selenium 自动化技巧</p>
<h3 id="窗口大小"><a href="#窗口大小" class="headerlink" title="窗口大小"></a>窗口大小</h3><p>有时间我们需要获取窗口的属性和相应的信息，并对窗口进行控制</p>
<ul>
<li>获取窗口大小</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get_window_size()</span><br></pre></td></tr></table></figure>

<ul>
<li>改变窗口大小</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.set_window_size(x, y)</span><br></pre></td></tr></table></figure>

<h3 id="获取当前窗口标题"><a href="#获取当前窗口标题" class="headerlink" title="获取当前窗口标题"></a>获取当前窗口标题</h3><p>浏览网页的时候，我们的窗口标题是不断变化的，可以使用WebDriver的title属性来获取当前窗口的标题栏字符串。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.title</span><br></pre></td></tr></table></figure>

<h3 id="获取当前窗口URL地址"><a href="#获取当前窗口URL地址" class="headerlink" title="获取当前窗口URL地址"></a>获取当前窗口URL地址</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.current_url</span><br></pre></td></tr></table></figure>

<p>例如，访问网易，并获取当前窗口的标题和URL</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span>  webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开网站</span></span><br><span class="line">driver.get(<span class="string">&#x27;https://www.163.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取网站标题栏文本</span></span><br><span class="line"><span class="built_in">print</span>(driver.title) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取网站地址栏文本</span></span><br><span class="line"><span class="built_in">print</span>(driver.current_url) </span><br></pre></td></tr></table></figure>

<h3 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h3><p>有的时候，我们需要把浏览器屏幕内容保存为图片文件。</p>
<p>比如，做自动化测试时，一个测试用例检查点发现错误，我们可以截屏为文件，以便测试结束时进行人工核查。</p>
<p>可以使用 WebDriver 的 get_screenshot_as_file方法来截屏并保存为图片。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span>  webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开网站</span></span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 截屏保存为图片文件</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="string">&#x27;1.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="手机模式"><a href="#手机模式" class="headerlink" title="手机模式"></a>手机模式</h3><p>我们可以通过 <code>desired_capabilities</code> 参数，指定以手机模式打开chrome浏览器</p>
<p>参考代码，如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">mobile_emulation = &#123; <span class="string">&quot;deviceName&quot;</span>: <span class="string">&quot;Nexus 5&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">chrome_options = webdriver.ChromeOptions()</span><br><span class="line"></span><br><span class="line">chrome_options.add_experimental_option(<span class="string">&quot;mobileEmulation&quot;</span>, mobile_emulation)</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome( desired_capabilities = chrome_options.to_capabilities())</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h3 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h3><p>有时候，网站操作需要上传文件。</p>
<p>比如，著名的在线图片压缩网站： <a target="_blank" rel="noopener" href="https://tinypng.com/">https://tinypng.com/</a></p>
<p>通常，网站页面上传文件的功能，是通过 <code>type</code> 属性 为 <code>file</code> 的 HTML <code>input</code> 元素实现的。</p>
<p>如下所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">multiple</span>=<span class="string">&quot;multiple&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用selenium自动化上传文件，我们只需要定位到该input元素，然后通过 send_keys 方法传入要上传的文件路径即可。</p>
<p>如下所示：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先定位到上传文件的 input 元素</span></span><br><span class="line">ele = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;input[type=file]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再调用 WebElement 对象的 send_keys 方法</span></span><br><span class="line">ele.send_keys(<span class="string">r&#x27;h:\g02.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>如果需要上传多个文件，可以多次调用send_keys，如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ele = wd.find_element(By.CSS_SELECTOR,  <span class="string">&#x27;input[type=file]&#x27;</span>)</span><br><span class="line">ele.send_keys(<span class="string">r&#x27;h:\g01.png&#x27;</span>)</span><br><span class="line">ele.send_keys(<span class="string">r&#x27;h:\g02.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>但是，有的网页上传，是没有 file 类型 的 input 元素的。</p>
<p>如果是Windows上的自动化，可以采用 Windows 平台专用的方法：</p>
<p>执行</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pypiwin32</span><br></pre></td></tr></table></figure>

<p>确保 pywin32 已经安装，然后参考如下示例代码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找到点击上传的元素，点击</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;.dropzone&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) <span class="comment"># 等待上传选择文件对话框打开</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接发送键盘消息给 当前应用程序，</span></span><br><span class="line"><span class="comment"># 前提是浏览器必须是当前应用</span></span><br><span class="line"><span class="keyword">import</span> win32com.client</span><br><span class="line">shell = win32com.client.Dispatch(<span class="string">&quot;WScript.Shell&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入文件路径，最后的&#x27;\n&#x27;，表示回车确定，也可能时 &#x27;\r&#x27; 或者 &#x27;\r\n&#x27;</span></span><br><span class="line">shell.Sendkeys(<span class="string">r&quot;h:\a2.png&quot;</span> + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h2 id="自动化Edge浏览器"><a href="#自动化Edge浏览器" class="headerlink" title="自动化Edge浏览器"></a>自动化Edge浏览器</h2><p>自动化基于Chromium内核的 微软最新Edge浏览器，首先需要查看Edge的版本。</p>
<p>点击菜单 <code>帮助和反馈</code> &gt; <code>关于Microsoft Edge</code> ，在弹出界面中，查看到版本，比如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">版本 <span class="number">95.0</span><span class="number">.1020</span><span class="number">.30</span> (官方内部版本) (<span class="number">64</span> 位)</span><br></pre></td></tr></table></figure>

<p>然后 <a target="_blank" rel="noopener" href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/#downloads">点击这里，打开Edge浏览器驱动下载网页</a> ，并选择下载对应版本的驱动。</p>
<p>在自动化代码中，指定使用Edge Webdriver类，并且指定 Edge 驱动路径，如下所示</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge(<span class="string">r&#x27;d:\tools\webdrivers\msedgedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&#x27;http://www.51job.com&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="Xpath选择器"><a href="#Xpath选择器" class="headerlink" title="Xpath选择器"></a>Xpath选择器</h1><h2 id="Xpath语法简介"><a href="#Xpath语法简介" class="headerlink" title="Xpath语法简介"></a>Xpath语法简介</h2><p>前面我们学习了CSS 选择元素，大家可以发现非常灵活、强大，还有一种 灵活、强大 的选择元素的方式，就是使用 <code>Xpath</code> 表达式。</p>
<p>XPath (XML Path Language) 是由国际标准化组织W3C指定的，用来在 XML 和 HTML 文档中选择节点的语言。</p>
<p>目前主流浏览器 (chrome、firefox，edge，safari) 都支持XPath语法，xpath有 1 和 2 两个版本，目前浏览器支持的是 xpath 1的语法。</p>
<p>既然已经有了CSS，为什么还要学习 Xpath呢？ 因为</p>
<ul>
<li>有些场景 用 css 选择web 元素 很麻烦，而xpath 却比较方便。</li>
<li>另外 Xpath 还有其他领域会使用到，比如 爬虫框架 Scrapy， 手机App框架 Appium。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/test1.html">请点击打开这个网址</a></p>
<p>按F12打开调试窗口，点击 Elements标签。</p>
<p>要验证 Xpath 语法是否能成功选择元素，也可以像 验证 CSS 语法那样，按组合键 Ctrl + F ，就会出现 搜索框</p>
<p>xpath 语法中，整个HTML文档根节点用’&#x2F;‘表示，如果我们想选择的是根节点下面的html节点，则可以在搜索框输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/html</span><br></pre></td></tr></table></figure>

<p>如果输入下面的表达式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/html/body/div</span><br></pre></td></tr></table></figure>

<p>这个表达式表示选择html下面的body下面的div元素。</p>
<p>注意 <code>/</code> 有点像 CSS中的 <code>&gt;</code> , 表示直接子节点关系。</p>
<h3 id="绝对路径选择"><a href="#绝对路径选择" class="headerlink" title="绝对路径选择"></a>绝对路径选择</h3><p>从根节点开始的，到某个节点，每层都依次写下来，每层之间用 <code>/</code> 分隔的表达式，就是某元素的 <code>绝对路径</code></p>
<p>上面的xpath表达式 <code>/html/body/div</code> ，就是一个绝对路径的xpath表达式， 等价于 css表达式 <code>html&gt;body&gt;div</code></p>
<p>自动化程序要使用Xpath来选择web元素，应该调用 WebDriver对象的方法 <code>find_element_by_xpath</code> 或者 <code>find_elements_by_xpath</code>，像这样：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.XPATH, <span class="string">&quot;/html/body/div&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="相对路径选择"><a href="#相对路径选择" class="headerlink" title="相对路径选择"></a>相对路径选择</h3><p>有的时候，我们需要选择网页中某个元素， <code>不管它在什么位置</code> 。</p>
<p>比如，选择示例页面的所有标签名为 <code>div</code> 的元素，如果使用css表达式，直接写一个 <code>div</code> 就行了。</p>
<p>那xpath怎么实现同样的功能呢？ xpath需要前面加 <code>//</code> , 表示从当前节点往下寻找所有的后代元素,不管它在什么位置。</p>
<p>所以xpath表达式，应该这样写： <code>//div</code></p>
<p>‘&#x2F;&#x2F;’ 符号也可以继续加在后面,比如，要选择 所有的 div 元素里面的 所有的 p 元素 ，不管div 在什么位置，也不管p元素在div下面的什么位置，则可以这样写 <code>//div//p</code></p>
<p>对应的自动化程序如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.XPATH, <span class="string">&quot;//div//p&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>如果使用CSS选择器，对应代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.CSS_SELECTOR,<span class="string">&quot;div p&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>如果，要选择 所有的 div 元素里面的 直接子节点 p ， xpath，就应该这样写了 <code>//div/p</code></p>
<p>如果使用CSS选择器，则为 <code>div &gt; p</code></p>
<h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h3><p>如果要选择所有div节点的所有直接子节点，可以使用表达式 <code>//div/*</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*` 是一个通配符，对应任意节点名的元素，等价于CSS选择器 `div &gt; *</span><br></pre></td></tr></table></figure>

<p>代码如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.XPATH, <span class="string">&quot;//div/*&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="根据属性选择-1"><a href="#根据属性选择-1" class="headerlink" title="根据属性选择"></a>根据属性选择</h2><p>Xpath 可以根据属性来选择元素。</p>
<p>根据属性来选择元素 是通过 这种格式来的 <code>[@属性名=&#39;属性值&#39;]</code></p>
<p>注意：</p>
<ul>
<li>属性名注意前面有个@</li>
<li>属性值一定要用引号， 可以是单引号，也可以是双引号</li>
</ul>
<h3 id="根据id属性选择"><a href="#根据id属性选择" class="headerlink" title="根据id属性选择"></a>根据id属性选择</h3><p>选择 id 为 west 的元素，可以这样 <code>//*[@id=&#39;west&#39;]</code></p>
<h3 id="根据class属性选择"><a href="#根据class属性选择" class="headerlink" title="根据class属性选择"></a>根据class属性选择</h3><p>选择所有 select 元素中 class为 single_choice 的元素，可以这样 <code>//select[@class=&#39;single_choice&#39;]</code></p>
<p>如果一个元素class 有多个，比如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;beijing&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;capital huge-city&#x27;</span>&gt;</span></span><br><span class="line">    北京    </span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果要选 它， 对应的 xpath 就应该是 <code>//p[@class=&quot;capital huge-city&quot;]</code></p>
<p>不能只写一个属性，像这样 <code>//p[@class=&quot;capital&quot;]</code> 则不行</p>
<h3 id="根据其他属性"><a href="#根据其他属性" class="headerlink" title="根据其他属性"></a>根据其他属性</h3><p>同样的道理，我们也可以利用其它的属性选择</p>
<p>比如选择 具有multiple属性的所有页面元素 ，可以这样 <code>//*[@multiple]</code></p>
<h3 id="属性值包含字符串"><a href="#属性值包含字符串" class="headerlink" title="属性值包含字符串"></a>属性值包含字符串</h3><p>要选择 style属性值 包含 color 字符串的 页面元素 ，可以这样 <code>//*[contains(@style,&#39;color&#39;)]</code></p>
<p>要选择 style属性值 以 color 字符串 <code>开头</code> 的 页面元素 ，可以这样 <code>//*[starts-with(@style,&#39;color&#39;)]</code></p>
<p>要选择 style属性值 以 某个 字符串 结尾 的 页面元素 ，大家可以推测是 <code>//*[ends-with(@style,&#39;color&#39;)]</code>， 但是，很遗憾，这是xpath 2.0 的语法 ，目前浏览器都不支持</p>
<h2 id="按次序选择"><a href="#按次序选择" class="headerlink" title="按次序选择"></a>按次序选择</h2><p>前面学过css表达式可以根据元素在父节点中的次序选择， 非常实用。</p>
<p>xpath也可以根据次序选择元素。 语法比css更简洁，直接在方括号中使用数字表示次序</p>
<p>比如</p>
<h3 id="某类型-第几个-子元素"><a href="#某类型-第几个-子元素" class="headerlink" title="某类型 第几个 子元素"></a>某类型 第几个 子元素</h3><p>比如</p>
<p>要选择 p类型第2个的子元素，就是</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//p[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p>注意，选择的是 <code>p类型第2个的子元素</code> ， 不是 <code>第2个子元素，并且是p类型</code> 。</p>
<p>注意体会区别</p>
<p>再比如，要选取父元素为div 中的 p类型 第2个 子元素</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//div/p[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h3 id="第几个子元素"><a href="#第几个子元素" class="headerlink" title="第几个子元素"></a>第几个子元素</h3><p>也可以选择第2个子元素，不管是什么类型，采用通配符</p>
<p>比如 选择父元素为div的第2个子元素，不管是什么类型</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//div/*[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h3 id="某类型-倒数第几个-子元素"><a href="#某类型-倒数第几个-子元素" class="headerlink" title="某类型 倒数第几个 子元素"></a>某类型 倒数第几个 子元素</h3><p>当然也可以选取倒数第几个子元素</p>
<p>比如：</p>
<ul>
<li>选取p类型倒数第1个子元素</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//p[last()]</span><br></pre></td></tr></table></figure>

<ul>
<li>选取p类型倒数第2个子元素</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//p[last()-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>选择父元素为div中p类型倒数第3个子元素</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//div/p[last()-<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h3 id="范围选择"><a href="#范围选择" class="headerlink" title="范围选择"></a>范围选择</h3><p>xpath还可以选择子元素的次序范围。</p>
<p>比如，</p>
<ul>
<li>选取option类型第1到2个子元素</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//option[position()&lt;=<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//option[position()&lt;<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>选择class属性为multi_choice的前3个子元素</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;multi_choice&#x27;</span>]/*[position()&lt;=<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>选择class属性为multi_choice的后3个子元素</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;multi_choice&#x27;</span>]/*[position()&gt;=last()-<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p>为什么不是 <code>last()-3</code> 呢？ 因为</p>
<p><code>last()</code> 本身代表最后一个元素</p>
<p><code>last()-1</code> 本身代表倒数第2个元素</p>
<p><code>last()-2</code> 本身代表倒数第3个元素</p>
<h2 id="组选择、父节点、兄弟节点"><a href="#组选择、父节点、兄弟节点" class="headerlink" title="组选择、父节点、兄弟节点"></a>组选择、父节点、兄弟节点</h2><h3 id="组选择-1"><a href="#组选择-1" class="headerlink" title="组选择"></a>组选择</h3><p>css有组选择，可以同时使用多个表达式，多个表达式选择的结果都是要选择的元素</p>
<p>css 组选择，表达式之间用 <strong>逗号</strong> 隔开</p>
<p>xpath也有组选择， 是用 <strong>竖线</strong> 隔开多个表达式</p>
<p>比如，要选所有的option元素 和所有的 h4 元素，可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//option | //h4</span><br></pre></td></tr></table></figure>

<p>等同于CSS选择器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">option , h4</span><br></pre></td></tr></table></figure>

<p>再比如，要选所有的 class 为 single_choice 和 class 为 multi_choice 的元素，可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@class=&#x27;single_choice&#x27;] | //*[@class=&#x27;multi_choice&#x27;]</span><br></pre></td></tr></table></figure>

<p>等同于CSS选择器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.single_choice , .multi_choice</span><br></pre></td></tr></table></figure>

<h3 id="选择父节点"><a href="#选择父节点" class="headerlink" title="选择父节点"></a>选择父节点</h3><p>xpath可以选择父节点， 这是css做不到的。</p>
<p>某个元素的父节点用 <code>/..</code> 表示</p>
<p>比如，要选择 id 为 china 的节点的父节点，可以这样写 <code>//*[@id=&#39;china&#39;]/..</code> 。</p>
<p>当某个元素没有特征可以直接选择，但是它有子节点有特征， 就可以采用这种方法，先选择子节点，再指定父节点。</p>
<p>还可以继续找上层父节点，比如 <code>//*[@id=&#39;china&#39;]/../../..</code></p>
<h3 id="兄弟节点选择-1"><a href="#兄弟节点选择-1" class="headerlink" title="兄弟节点选择"></a>兄弟节点选择</h3><p>前面学过 css选择器，要选择某个节点的后续兄弟节点，用 <strong>波浪线</strong></p>
<p>xpath也可以选择 后续 兄弟节点，用这样的语法 <code>following-sibling::</code></p>
<p>比如，要选择 class 为 single_choice 的元素的所有后续兄弟节点 <code>//*[@class=&#39;single_choice&#39;]/following-sibling::*</code></p>
<p>等同于CSS选择器 <code>.single_choice ~ *</code></p>
<p>如果，要选择后续节点中的div节点， 就应该这样写 <code>//*[@class=&#39;single_choice&#39;]/following-sibling::div</code></p>
<p>xpath还可以选择 <code>前面的</code> 兄弟节点，用这样的语法 <code>preceding-sibling::</code></p>
<p>比如，要选择 class 为 single_choice 的元素的 <code>所有</code> 前面的兄弟节点，这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@class=&#x27;single_choice&#x27;]/preceding-sibling::*</span><br></pre></td></tr></table></figure>

<p>要选择 class 为 single_choice 的元素的</p>
<p>前面最靠近的兄弟节点 , 这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@class=&#x27;single_choice&#x27;]/preceding-sibling::*[1]</span><br></pre></td></tr></table></figure>

<p>前面第2靠近的兄弟节点 , 这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@class=&#x27;single_choice&#x27;]/preceding-sibling::*[2]</span><br></pre></td></tr></table></figure>

<p>而 CSS选择器 目前还没有方法选择 <code>前面的</code> 兄弟节点</p>
<p>要了解更多Xpath选择语法，可以<a target="_blank" rel="noopener" href="http://www.w3school.com.cn/xpath/index.asp">点击这里，打开Xpath选择器参考手册</a></p>
<h2 id="selenium-注意点"><a href="#selenium-注意点" class="headerlink" title="selenium 注意点"></a>selenium 注意点</h2><p>我们来看一个例子</p>
<p>我们的代码：</p>
<ul>
<li>先选择示例网页中，id是china的元素</li>
<li>然后通过这个元素的WebElement对象，使用find_elements_by_xpath，选择里面的p元素，</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先寻找id是china的元素</span></span><br><span class="line">china = wd.find_element(By.ID, <span class="string">&#x27;china&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再选择该元素内部的p元素</span></span><br><span class="line">elements = china.find_elements(By.XPATH, <span class="string">&#x27;//p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印结果</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>运行发现，打印的 不仅仅是 china内部的p元素， 而是所有的p元素。</p>
<p>要在某个元素内部使用xpath选择元素， 需要 <code>在xpath表达式最前面加个点</code> 。</p>
<p>像这样</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = china.find_elements(By.XPATH, <span class="string">&#x27;.//p&#x27;</span>)</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/mm_facetoface_collect_qrcode_1690448192277.png" alt="天海 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="https://tianhei-alyun.oss-cn-beijing.aliyuncs.com/1690448212406.jpg" alt="天海 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/%E7%88%AC%E8%99%AB/" rel="tag"># 爬虫　</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/08/03/anaconda/01.anaconda%E5%9F%BA%E7%A1%80/" rel="prev" title="Anaconda">
                  <i class="fa fa-angle-left"></i> Anaconda
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/08/07/python%E7%88%AC%E8%99%AB/01%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80/" rel="next" title="爬虫基础">
                  爬虫基础 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">天海</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
